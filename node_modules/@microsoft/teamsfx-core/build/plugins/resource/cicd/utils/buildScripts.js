"use strict";
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license.
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateBuildScript = void 0;
const projectSettingsHelperV3_1 = require("../../../../common/projectSettingsHelperV3");
const globalVars_1 = require("../../../../core/globalVars");
// TODO: add support for VS/.Net Projects.
function generateBuildScript(projectSettings) {
    const parts = [];
    if (globalVars_1.isV3()) {
        const settingsV3 = projectSettings;
        if (projectSettingsHelperV3_1.hasAzureTab(settingsV3))
            parts.push("cd tabs; npm ci; npm run build; cd -;");
        if (projectSettingsHelperV3_1.hasSPFxTab(settingsV3))
            parts.push("cd SPFx; npm ci; npm run build; cd -;");
        if (projectSettingsHelperV3_1.hasBot(settingsV3)) {
            if (projectSettings.programmingLanguage === "typescript") {
                parts.push("cd bot; npm ci; npm run build; cd -;");
            }
            else {
                parts.push("cd bot; npm ci; cd -;");
            }
        }
        if (projectSettingsHelperV3_1.hasApi(settingsV3) && projectSettings.programmingLanguage === "typescript") {
            parts.push("cd api; npm ci; npm run build; cd -;");
        }
    }
    else {
        const solutionSettings = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.solutionSettings;
        const capabilities = solutionSettings === null || solutionSettings === void 0 ? void 0 : solutionSettings["capabilities"];
        const azureResources = solutionSettings === null || solutionSettings === void 0 ? void 0 : solutionSettings["azureResources"];
        const hostType = solutionSettings === null || solutionSettings === void 0 ? void 0 : solutionSettings["hostType"];
        if (capabilities === null || capabilities === void 0 ? void 0 : capabilities.includes("Tab")) {
            if (hostType && hostType === "Azure")
                parts.push("cd tabs; npm ci; npm run build; cd -;");
            if (hostType && hostType === "SPFx")
                parts.push("cd SPFx; npm ci; npm run build; cd -;");
        }
        if ((capabilities === null || capabilities === void 0 ? void 0 : capabilities.includes("Bot")) || capabilities.includes("MessagingExtension")) {
            if (projectSettings.programmingLanguage === "typescript") {
                parts.push("cd bot; npm ci; npm run build; cd -;");
            }
            else {
                parts.push("cd bot; npm ci; cd -;");
            }
        }
        if ((azureResources === null || azureResources === void 0 ? void 0 : azureResources.includes("function")) &&
            projectSettings.programmingLanguage === "typescript") {
            parts.push("cd api; npm ci; npm run build; cd -;");
        }
    }
    return parts.join("");
}
exports.generateBuildScript = generateBuildScript;
//# sourceMappingURL=buildScripts.js.map