"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TelemetryUtils = void 0;
const solutionGlobalVars_1 = require("../../../solution/fx-solution/v3/solutionGlobalVars");
const constants_1 = require("../constants");
class TelemetryUtils {
    static init(telemetryReporter) {
        TelemetryUtils.telemetryReporter = telemetryReporter;
    }
    static sendEvent(eventName, success, properties, measurements) {
        var _a;
        if (!properties) {
            properties = {};
        }
        if (success) {
            properties[constants_1.Telemetry.properties.success] = constants_1.Telemetry.valueYes;
        }
        this.addProperties(properties);
        (_a = TelemetryUtils.telemetryReporter) === null || _a === void 0 ? void 0 : _a.sendTelemetryEvent(eventName, properties, measurements);
    }
    static sendErrorEvent(eventName, errorCode, errorType, errorMessage, properties, measurements) {
        var _a;
        if (!properties) {
            properties = {};
        }
        properties[constants_1.Telemetry.properties.success] = constants_1.Telemetry.valueNo;
        properties[constants_1.Telemetry.properties.errorCode] = errorCode;
        properties[constants_1.Telemetry.properties.errorType] = errorType;
        properties[constants_1.Telemetry.properties.errorMessage] = errorMessage;
        this.addProperties(properties);
        (_a = TelemetryUtils.telemetryReporter) === null || _a === void 0 ? void 0 : _a.sendTelemetryErrorEvent(eventName, properties, measurements);
    }
    static addProperties(properties) {
        properties[constants_1.Telemetry.properties.component] = constants_1.Telemetry.componentName;
        const appId = solutionGlobalVars_1.solutionGlobalVars.TeamsAppId;
        if (appId) {
            properties[constants_1.Telemetry.properties.appid] = appId;
        }
        else {
            properties[constants_1.Telemetry.properties.appid] = "";
        }
    }
}
exports.TelemetryUtils = TelemetryUtils;
//# sourceMappingURL=telemetryUtil.js.map