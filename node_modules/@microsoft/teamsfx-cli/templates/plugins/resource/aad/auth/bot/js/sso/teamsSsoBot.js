const{ConversationState,MemoryStorage,TeamsActivityHandler,UserState}=require("botbuilder"),{showUserInfo}=require("./showUserInfo"),{SsoDialog}=require("./ssoDialog");class TeamsSsoBot extends TeamsActivityHandler{constructor(){super();const memoryStorage=new MemoryStorage;this.conversationState=new ConversationState(memoryStorage),this.userState=new UserState(memoryStorage),this.dialog=new SsoDialog(new MemoryStorage,["User.Read"]),this.dialogState=this.conversationState.createProperty("DialogState"),this.dialog.addCommand("ShowUserProfile","show",showUserInfo),this.onMessage((async(context,next)=>{console.log("Running with Message Activity."),await this.dialog.run(context,this.dialogState),await next()}))}async run(context){await super.run(context),await this.conversationState.saveChanges(context,!1),await this.userState.saveChanges(context,!1)}async handleTeamsSigninVerifyState(context,query){console.log("Running dialog with signin/verifystate from an Invoke Activity."),await this.dialog.run(context,this.dialogState)}async handleTeamsSigninTokenExchange(context,query){await this.dialog.run(context,this.dialogState)}async onSignInInvoke(context){await this.dialog.run(context,this.dialogState)}}exports.TeamsSsoBot=TeamsSsoBot;