{"version":3,"file":"functions.js","mappings":"yBACA,IAAIA,EAAsB,CAAC,E,6WCOpB,WAA8BC,EAAcC,EAAeC,GAA3D,gHACqBC,IADrB,UACCC,EADD,OAGCC,EAAoBC,EAAgB,eAAgBF,GACpDG,EAAqBD,EAAgB,gBAAiBF,GACtDI,EAAoBF,EAAgB,eAAgBF,GACpDK,EAAqBH,EAAgB,gBAAiBF,GAEtDM,EAAcN,EAAYO,MAC9B,SAACC,GAAD,OACEA,EAAQP,KAAuBL,GAC/BY,EAAQL,KAAwBN,GAChCW,EAAQJ,KAAuBN,CAHjC,IATG,uBAgBS,IAAIW,gBAAgBC,MAC9BD,gBAAgBE,UAAUC,aADhB,yDAEwChB,EAFxC,4BAEwEC,EAFxE,2BAEwGC,IAlBjH,iCAuBEQ,EAAYD,IAvBd,6C,sBCPPV,EAAoBkB,EAAI,SAASC,EAASC,GACzC,IAAI,IAAIC,KAAOD,EACXpB,EAAoBsB,EAAEF,EAAYC,KAASrB,EAAoBsB,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAG3E,ECPArB,EAAoBsB,EAAI,SAASK,EAAKC,GAAQ,OAAOL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,EAAO,EFkCtG,IAAMxB,EAAQ,4CAAG,yHAEP4B,EAAU,IAAIC,MAAMC,eACpBC,EAAYH,EAAQI,SAASC,WAAWC,QAAQ,QAChDC,EAAQJ,EAAU/B,SAAS,iBAC3BC,EAAckC,EAAMC,KAAK,UALlB,SAMPR,EAAQS,OAND,gCAONpC,EAAYqC,QAPN,wCASD,IAAI5B,gBAAgBC,MAC9BD,gBAAgBE,UAAU2B,aADhB,uDAEsC,KAAYC,UAXjD,0DAAH,qDAiBRrC,EAAkB,SAACsC,EAAYxC,GACnC,IAAMyC,EAAQzC,EAAY,GAAG0C,WAAU,SAAClC,GAAD,OAAaA,IAAYgC,CAAzB,IACvC,IAAe,IAAXC,EAKF,MAJY,IAAIhC,gBAAgBC,MAC9BD,gBAAgBE,UAAU2B,aADhB,UAEPE,EAFO,wDAMd,OAAOC,CACR,EAEDhC,gBAAgBkC,UAAU,kBAvDnB,SAAP,wC","sources":["webpack://excel-custom-functions-js/webpack/bootstrap","webpack://excel-custom-functions-js/./src/functions/functions.js","webpack://excel-custom-functions-js/webpack/runtime/define property getters","webpack://excel-custom-functions-js/webpack/runtime/hasOwnProperty shorthand"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","/**\n * @customfunction GetStreamValue\n * @param {number} streamNumber\n * @param {string} operatingCase\n * @param {string} propertyType\n * @returns {string} of PropertyValue.\n */\n\nexport async function getStreamValue(streamNumber, operatingCase, propertyType) {\n  const searchRange = await getRange();\n\n  const streamNumberIndex = findHeaderIndex(\"StreamNumber\", searchRange);\n  const operatingCaseIndex = findHeaderIndex(\"OperatingCase\", searchRange);\n  const propertyTypeIndex = findHeaderIndex(\"PropertyType\", searchRange);\n  const propertyValueIndex = findHeaderIndex(\"PropertyValue\", searchRange);\n\n  const matchingRow = searchRange.find(\n    (element) =>\n      element[streamNumberIndex] === streamNumber &&\n      element[operatingCaseIndex] === operatingCase &&\n      element[propertyTypeIndex] === propertyType\n  );\n\n  if (!matchingRow) {\n    let error = new CustomFunctions.Error(\n      CustomFunctions.ErrorCode.notAvailable,\n      `Could not find PropertyValue for StreamNumber: ${streamNumber}, OperatingCase: ${operatingCase}, PropertyType: ${propertyType}`\n    );\n    throw error;\n  }\n\n  return matchingRow[propertyValueIndex];\n}\n\nconst getRange = async () => {\n  try {\n    const context = new Excel.RequestContext();\n    const worksheet = context.workbook.worksheets.getItem(\"Test\");\n    const range = worksheet.getRange(\"PropTypeValue\");\n    const searchRange = range.load(\"values\");\n    await context.sync();\n    return searchRange.values;\n  } catch (searchError) {\n    let error = new CustomFunctions.Error(\n      CustomFunctions.ErrorCode.invalidValue,\n      `Search range not found with following error: ${searchError.message}`\n    );\n    throw error;\n  }\n};\n\nconst findHeaderIndex = (headerName, searchRange) => {\n  const index = searchRange[0].findIndex((element) => element === headerName);\n  if (index === -1) {\n    let error = new CustomFunctions.Error(\n      CustomFunctions.ErrorCode.invalidValue,\n      `${headerName} not found in header row (first row of searchRange)`\n    );\n    throw error;\n  }\n  return index;\n};\n\nCustomFunctions.associate(\"GETSTREAMVALUE\", getStreamValue);","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }"],"names":["__webpack_require__","streamNumber","operatingCase","propertyType","getRange","searchRange","streamNumberIndex","findHeaderIndex","operatingCaseIndex","propertyTypeIndex","propertyValueIndex","matchingRow","find","element","CustomFunctions","Error","ErrorCode","notAvailable","d","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","context","Excel","RequestContext","worksheet","workbook","worksheets","getItem","range","load","sync","values","invalidValue","message","headerName","index","findIndex","associate"],"sourceRoot":""}